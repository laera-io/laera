# Læra

**Læra** (or **Laera**, from [Icelandic/Norwegian/Faroese][laera_wiki] - to learn) is the Android application for words learning.

## Screenshots

![flow page][flow_page_jpg]| ![new page][new_page_jpg] | ![words page][words_page_jpg]
---------------------------|---------------------------|--------------------------

## Dependencies

* Install `ruby` and `gem` into your OS
* install gem file dependencies: `make deps`

## Dev

### Autogenerated code

> All files ended with `.g.dart` are autogenerated.

To regenerate all `.g.dart` files:

```sh
make generate
```

### Build apk

```sh
make build-apk-dev
```

The result will be at `build/app/outputs/flutter-apk/app-debug.apk`.

### Build app icons

Change `assets/icon/logo.png` and then:

```sh
make icon
```

## Release

### Extra dependencies

* `mkdir -p android/fastlane/keys`
* Put there some files:
  * `google_play_api_key.json` - [api key from `https://play.google.com/console/u/<user_id>/developers/<dev_id>/api-access`][google_play_api_key_docs]
  * `keystore.jks` - [signing key](#generate-jks-file)
  * `keystore.properties` - [properties for `keystore.jks`](#keystoreproperties-file)

### Build

* `make build-aab`

## Signing

> Signing key must be a 2048 bit RSA key and have 25-year validity

### Generate `.jks` file

```sh
keytool -genkeypair -alias <alias_name> -keyalg RSA -keysize 2048 -validity 9125 -keystore keystore.jks
```

### `keystore.properties` file

```txt
storeFile=../fastlane/keys/keystore.jks
storePassword=<jks_password>
keyAlias=<alias_name>
keyPassword=<jks_password>
```

### Generate `.pem` certificate

```sh
keytool -export -rfc -alias <alias_name> -file upload_certificate.pem -keystore keystore.jks
```

### Generate data for CI/CD

```sh
base64 -w 0 <file_name>
```

[laera_wiki]: https://en.wiktionary.org/wiki/l%C3%A6ra
[google_play_api_key_docs]: https://developers.google.com/android-publisher/getting_started

[flow_page_jpg]: android/fastlane/metadata/android/en-US/images/phoneScreenshots/1_en-US.jpeg
[new_page_jpg]: android/fastlane/metadata/android/en-US/images/phoneScreenshots/2_en-US.jpeg
[words_page_jpg]: android/fastlane/metadata/android/en-US/images/phoneScreenshots/3_en-US.jpeg
